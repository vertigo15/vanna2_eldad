{
"common_queries": [
{
"category": "basic_selects",
"description": "Get recent customers (first purchase in last 30 days)",
"sql": "SELECT customerkey, customeralternatekey, firstname, lastname, emailaddress, datefirstpurchase\nFROM public.dimcustomer\nWHERE datefirstpurchase > CURRENT_DATE - INTERVAL '30 days'\nORDER BY datefirstpurchase DESC"
},
{
"category": "aggregations",
"description": "Internet sales amount by calendar year",
"sql": "SELECT d.calendaryear, SUM(f.salesamount::numeric) AS total_sales\nFROM public.factinternetsales f\nJOIN public.dimdate d ON f.orderdatekey = d.datekey\nGROUP BY d.calendaryear\nORDER BY d.calendaryear"
},
{
"category": "time_series",
"description": "Daily internet sales (last 30 days)",
"sql": "SELECT d.fulldatealternatekey AS order_date,\n COUNT() AS lines,\n SUM(f.salesamount::numeric) AS revenue\nFROM public.factinternetsales f\nJOIN public.dimdate d ON f.orderdatekey = d.datekey\nWHERE d.fulldatealternatekey > CURRENT_DATE - INTERVAL '30 days'\nGROUP BY d.fulldatealternatekey\nORDER BY order_date DESC"
},
{
"category": "top_n",
"description": "Top 10 products by internet revenue",
"sql": "SELECT p.productkey, p.englishproductname AS product_name,\n SUM(f.salesamount::numeric) AS revenue\nFROM public.factinternetsales f\nJOIN public.dimproduct p ON f.productkey = p.productkey\nGROUP BY p.productkey, p.englishproductname\nORDER BY revenue DESC\nLIMIT 10"
},
{
"category": "joins",
"description": "Sample customer purchases with product and order info",
"sql": "SELECT f.salesordernumber, f.salesorderlinenumber, c.customeralternatekey,\n p.englishproductname AS product_name, d.fulldatealternatekey AS order_date,\n f.orderquantity, f.unitprice::numeric, f.salesamount::numeric\nFROM public.factinternetsales f\nJOIN public.dimcustomer c ON f.customerkey = c.customerkey\nJOIN public.dimproduct p ON f.productkey = p.productkey\nJOIN public.dimdate d ON f.orderdatekey = d.datekey\nORDER BY d.fulldatealternatekey DESC\nLIMIT 100"
},
{
"category": "aggregations",
"description": "Sales by promotion (internet channel)",
"sql": "SELECT COALESCE(pr.englishpromotionname, 'No Promotion') AS promotion,\n COUNT() AS lines,\n SUM(f.discountamount::numeric) AS total_discount,\n SUM(f.salesamount::numeric) AS revenue\nFROM public.factinternetsales f\nLEFT JOIN public.dimpromotion pr ON f.promotionkey = pr.promotionkey\nGROUP BY COALESCE(pr.englishpromotionname, 'No Promotion')\nORDER BY revenue DESC"
},
{
"category": "window_functions",
"description": "Running total of internet sales by date",
"sql": "WITH daily AS (\n SELECT d.fulldatealternatekey AS order_date,\n SUM(f.salesamount::numeric) AS revenue\n FROM public.factinternetsales f\n JOIN public.dimdate d ON f.orderdatekey = d.datekey\n GROUP BY d.fulldatealternatekey\n)\nSELECT order_date,\n revenue,\n SUM(revenue) OVER (ORDER BY order_date ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS running_total\nFROM daily\nORDER BY order_date"
},
{
"category": "currency_rates",
"description": "Average and end-of-day currency rates per month",
"sql": "SELECT d.calendaryear, d.monthnumberofyear AS month,\n c.currencyname,\n AVG(f.averagerate) AS avg_rate,\n AVG(f.endofdayrate) AS avg_eod_rate\nFROM public.factcurrencyrate f\nJOIN public.dimdate d ON f.datekey = d.datekey\nJOIN public.dimcurrency c ON f.currencykey = c.currencykey\nGROUP BY d.calendaryear, d.monthnumberofyear, c.currencyname\nORDER BY d.calendaryear, month, c.currencyname"
},
{
"category": "reseller_sales",
"description": "Reseller sales by salesperson",
"sql": "SELECT e.firstname || ' ' || e.lastname AS salesperson,\n SUM(fr.salesamount::numeric) AS revenue,\n COUNT() AS lines\nFROM public.factresellersales fr\nJOIN public.dimemployee e ON fr.employeekey = e.employeekey\nGROUP BY salesperson\nORDER BY revenue DESC"
},
{
"category": "sales_reasons",
"description": "Internet sales reasons distribution",
"sql": "SELECT r.salesreasonname, r.salesreasonreasontype,\n COUNT() AS occurrences\nFROM public.factinternetsalesreason br\nJOIN public.dimsalesreason r ON br.salesreasonkey = r.salesreasonkey\nGROUP BY r.salesreasonname, r.salesreasonreasontype\nORDER BY occurrences DESC"
},
{
"category": "heb_basic_selects",
"description": "לקוחות חדשים ב-30 הימים האחרונים",
"sql": "SELECT customerkey, customeralternatekey, firstname, lastname, emailaddress, datefirstpurchase\nFROM public.dimcustomer\nWHERE datefirstpurchase > CURRENT_DATE - INTERVAL '30 days'\nORDER BY datefirstpurchase DESC"
},
{
"category": "heb_aggregations",
"description": "סכום מכירות אינטרנט לפי אזור מכירות",
"sql": "SELECT st.salesterritorygroup AS territory_group,\n st.salesterritorycountry AS country,\n SUM(f.salesamount::numeric) AS revenue\nFROM public.factinternetsales f\nJOIN public.dimsalesterritory st ON f.salesterritorykey = st.salesterritorykey\nGROUP BY st.salesterritorygroup, st.salesterritorycountry\nORDER BY revenue DESC"
},
{
"category": "heb_filters",
"description": "לקוחות עם הכנסה שנתית גבוהה מ-100,000",
"sql": "SELECT customerkey, firstname, lastname, yearlyincome::numeric AS yearly_income\nFROM public.dimcustomer\nWHERE yearlyincome::numeric > 100000\nORDER BY yearly_income DESC"
},
{
"category": "time_series",
"description": "Monthly internet sales (last 12 months)",
"sql": "SELECT d.calendaryear, d.monthnumberofyear AS month,\n SUM(f.salesamount::numeric) AS revenue\nFROM public.factinternetsales f\nJOIN public.dimdate d ON f.orderdatekey = d.datekey\nWHERE d.fulldatealternatekey >= (date_trunc('month', CURRENT_DATE) - INTERVAL '11 months')\nGROUP BY d.calendaryear, d.monthnumberofyear\nORDER BY d.calendaryear, month"
}
]
}